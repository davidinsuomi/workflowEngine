<!-- HelloWorld BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Fri Jun 13 09:25:03 EEST 2014 -->
<process name="ExecuteWorkflow"
    targetNamespace="http://spica"
    xmlns:tns="http://spica"
    xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    >
    
    <!-- ================================================================= -->
    <!-- PARTNERLINKS                                                      -->
    <!-- List of services participating in this BPEL process               -->
    <!-- ================================================================= -->
    <partnerLinks>
        <!-- The 'client' role represents the requester of this service. -->
        <partnerLink name="clientPL"
        partnerLinkType="tns:ExecuteWorkflow"
        myRole="ExecuteWorkflowProvider"/>
        <partnerLink name="trustEvaluatorPL"
        partnerLinkType="tns:TrustEvaluation"
        myRole="TrustEvaluationRequester"
        partnerRole="TrustEvaluationProvider"/>
        <partnerLink name="mediatorPL"
        partnerLinkType="tns:SendData"
        myRole="SendDataRequester"
        partnerRole="SendDataProvider"/>

<partnerLink name="getDataPL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>
<partnerLink name="getData2PL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>
<partnerLink name="getData3PL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>
<partnerLink name="getData4PL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>
<partnerLink name="getData5PL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>
<partnerLink name="getData6PL"
    partnerLinkType="tns:GetData">https://dl.dropboxusercontent.com/u/59860036</partnerLink>

<partnerLink name="postDataPL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData2PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData3PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData4PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData5PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData6PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>
<partnerLink name="postData7PL"
    partnerLinkType="tns:PostData">https://posttestserver.com</partnerLink>

    </partnerLinks>
    
    <!-- ================================================================= -->
    <!-- VARIABLES                                                         -->
    <!-- List of messages and XML documents used within this BPEL process  -->
    <!-- ================================================================= -->
    <variables>
        <!-- Reference to the message passed as input during initiation -->
        <variable name="input"
        messageType="tns:ExecuteWorkflowRequestMessage"/>
        
        <!--
         Reference to the message that will be returned to the requester
         -->
        <variable name="output"
        messageType="tns:ExecuteWorkflowResponseMessage"/>
        
        <variable name="trustEvaluationInput"
        messageType="tns:TrustEvaluationRequestMessage"/>
        <variable name="trustEvaluationOutput"
        messageType="tns:TrustEvaluationResponseMessage"/>
        
        <variable name="sendDataInput"
        messageType="tns:SendDataRequestMessage"/>
        <variable name="sendDataOutput"
        messageType="tns:SendDataResponseMessage"/>
        
        <variable name="RRD2"
        messageType="tns:GetFileResponseMessage"/>
        <variable name="RRD3"
        messageType="tns:GetFileResponseMessage"/>
        
        <variable name="POSTData2Input"/>
        <variable name="POSTData2Output"/>
        <variable name="POSTData3Input"/>
        <variable name="POSTData3Output"/>
    </variables>
    
    <!-- ================================================================= -->
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->
    <sequence name="main">
        <assign name="AssignTrustEvaluationInput">
            <copy>
                <from variable="input"/>
                <to variable="trustEvaluationInput"/>
            </copy>
        </assign>
        <flow>
            <sequence>
                <invoke name="getData2"
                partnerLink="getData2PL"
                operation="Tierra_Azur.jpg"
                inputVariable=""
                outputVariable="RRD2"/>
                <assign name="assign2">
                    <copy>
                        <from variable="RRD2" />
                        <to variable="POSTData2Input" />
                    </copy>
                </assign>
                <invoke name="postData2"
                partnerLink="postData2PL"
                operation="post.php"
                inputVariable="POSTData2Input"
                outputVariable="POSTData2Output"/>
            </sequence>
            <sequence>
                <invoke name="getData3"
                partnerLink="getData3PL"
                operation="Tierra_Azur.jpg"
                inputVariable=""
                outputVariable="RRD3"/>
                <assign  name="assign3">
                    <copy>
                        <from variable="RRD3" />
                        <to variable="POSTData3Input" />
                    </copy>
                </assign>
                <invoke name="postData3"
                partnerLink="postData3PL"
                operation="post.php"
                inputVariable="POSTData3Input"
                outputVariable="POSTData3Output"/>
            </sequence>
            <sequence>
                <invoke name="getData4"
                partnerLink="getData4PL"
                operation="Tierra_Azur.jpg"
                inputVariable=""
                outputVariable="RRD4"/>
                <assign  name="assign4">
                    <copy>
                        <from variable="RRD4" />
                        <to variable="POSTData4Input" />
                    </copy>
                </assign>
                <invoke name="postData4"
                partnerLink="postData4PL"
                operation="post.php"
                inputVariable="POSTData4Input"
                outputVariable="POSTData4Output"/>
            </sequence>
        </flow>
        <invoke name="getData"
        partnerLink="getDataPL"
        operation="smallRatings.dat"
        inputVariable=""
        outputVariable="output"/>
    </sequence>
</process>

